# Установка

```pip install -e .```


# Введение

Библиотека предназначена для тиражированного проведения валидационных тестов, для всех типов моделей. И удобного оформления отчета. Перед началом работы с библиотекой рекомендуется ознамиться с основными концепциями изложенными ниже.

Основные классы, которыми оперирует библиотека это: ```Validation, Sampler, Scorer, Test```. Разберем по порядку назначение каждого из них.

### Sampler

Идея этого класса - бесконечный источник данных из того же распределения, что и данные пришедшие на валидацию. Реализовываться это может подкапотом как угодно (*bootstraping, resampling, time-backtracking*).

Причина появления этого класса: у некоторых моделей есть ограничения на resampling данных (*например объединить операции по ИНН и только потом разбивать на train и oos*). Данный класс позволяет абстрагироваться от этих тонкостей, предоставляя единый интерфейс. Если придет модель с нестандартными условиями на *resampling*, можно будет написать кастомный ```sampler``` и все также запустить тесты, без мороки.

### Scorer


Идея этого класса - посчитать скопом заранее заданные метрики при вызове метода ```scorer.score(...)```. 
Причина появления: модели могут оцениваются самыми разными способами, все не уложить в тип func(y_true, y_pred) (*например YOLO*). С помощью этого класса абстрагируемся от этого, оставляя реализацию в нестандартных случаях на валидатора.


### Test

Основной компонент библиотеки. На функцию, которая имплементирует тест, накладываются ограничения на сигнату. На вход она обязательно должна принимать ```scorer, sample, model``` плюс некоторые дополнительные параметры относящиеся к данному тесту. На выходе функции мы должны получать словарь со следующей структурой (стркутура взята из SberDS для совместимости)

Формат вывода:

```
{
    "semaphore": str one of {"gray", "green", "yellow", "red", },
    "result_dict": python object,
    "result_dataframes": List[pd.DataFrame],
    "result_plots": List[???],
}
```

где под ключом "semaphore" находится светофор выставленный за тест; под ключом "result_dict" находится нечто, что валидатор посчитает полезным для дальнейшего использования; под ключом "result_dataframes" находится список таблиц, которые будут отражены в агрегированном excel файле; под ключом "result_plots" находится список рисунков, которые будут отражены в агрегированном excel файле.

### Validation

Базовая цель этого класса это взять список тестов, запустить их, получить результат и агрегировать результаты в отчет.

Класс считывает ```Pipeline``` записанный в .xlxs файле (в нем хранится список тестов и их параметры в соответствии с методологии по данному набору моделей) затем выполняет каждый тест и собирает их результаты
